usethis::use_gpl3_license()
usethis::use_readme_rmd()
usethis::use_package_doc()
usethis::use_data_raw()
library(readxl)
library(sf)
library(tidyverse)
library(units)
gtha_taz <- st_read("TTS16-data-inputs/OD-by-FT-Employment/tts06_83_region.shp")
gtha_taz <- gtha_taz %>%
st_transform(crs = 32617)
gtha_taz <- gtha_taz %>%
transmute(GTA06 = as.character(GTA06),
AREA = st_area(geometry) %>%
set_units(km^2) %>%
drop_units())
ghta_taz_id <- gtha_taz$GTA06
od_ft <- read_delim(file = "TTS16-data-inputs/OD-by-FT-Employment/tts-2016-OD-FT-Employment.txt",
delim = "\t",
col_names = FALSE)
idx <- which(od_ft$X1 == "TABLE    : emp_stat (Full time)")
od_ft <- od_ft %>%
slice((idx+2):n())
od_ft <- od_ft %>%
separate(X1, into = c("Zones", "Persons"), sep = " (?=[^ ]+$)") %>%
mutate(Zones = str_trim(Zones, side = "both")) %>%
separate(Zones, into = c("Origin", "Destination"), sep = " (?=[^ ]+$)") %>%
mutate(Origin = str_trim(Origin),
Destination = str_trim(Destination),
Persons = as.numeric(Persons))
workers_ft <- od_ft %>%
group_by(Origin) %>%
summarize(workers = sum(Persons),
.groups = "drop") %>%
transmute(GTA06 = Origin,
workers)
jobs_ft <- od_ft %>%
group_by(Destination) %>%
summarize(jobs = sum(Persons),
.groups = "drop") %>%
transmute(GTA06 = Destination,
jobs)
gtha_taz <- gtha_taz %>%
# Join workers
left_join(workers_ft,
by = "GTA06") %>%
# Join jobs
left_join(jobs_ft,
by = "GTA06") %>%
# Replace NAs with zeros
mutate(workers = replace_na(workers, 0),
jobs = replace_na(jobs, 0))
ggplot() +
geom_sf(data = gtha_taz,
aes(fill = workers),
color = NA) +
scale_fill_fermenter(direction = 1)
ggplot() +
geom_sf(data = gtha_taz,
aes(fill = jobs),
color = NA) +
scale_fill_fermenter(direction = 1)
gtha_taz_cent <- st_centroid(gtha_taz)
#workers (origins)
workers_ft_cent <- workers_ft %>% merge(gtha_taz_cent %>% select(GTA06), by="GTA06") %>% st_sf
work_origins <- cbind(workers_ft_cent, st_coordinates(st_transform(workers_ft_cent, crs = 4326))) %>%
rename(lon = "X", lat = "Y", id = "GTA06") %>% as.data.frame()  %>%
select(id, lon, lat) %>% as.data.frame()
#jobs (destinations)
jobs_ft_cent <- jobs_ft %>% merge(gtha_taz_cent %>% select(GTA06), by="GTA06") %>% st_sf
job_destinations <- cbind(jobs_ft_cent, st_coordinates(st_transform(jobs_ft_cent, crs = 4326))) %>%
rename(lon = "X", lat = "Y", id = "GTA06") %>% as.data.frame()  %>%
select(id, lon, lat)
save("work_origins", file = "TTS16-data-inputs/Travel-Time-Calculations/inputs/work_origins.Rdata")
save("job_destinations", file = "TTS16-data-inputs/Travel-Time-Calculations/inputs/job_destinations.Rdata")
save("gtha_taz", file = "TTS16-data-inputs/OD-by-FT-Employment/gtha_taz.Rdata")
save("od_ft", file = "TTS16-data-inputs/OD-by-FT-Employment/od_ft.Rdata")
library(readxl)
library(sf)
library(tidyverse)
library(units)
library(ggmap)
library(scales)
#car travel times for all origins to all destinations (matrix)
load(file = "TTS16-data-inputs/Travel-Time-Calculations/results/output_OD_car1.Rdata")
# all, unique, traffic analysis zones with associated number of workers and jobs
load(file = "TTS16-data-inputs/OD-by-FT-Employment/gtha_taz.Rdata")
#Trips taken from origin to destination and associated people
load(file = "TTS16-data-inputs/OD-by-FT-Employment/od_ft.Rdata")
od_ft_tt <- od_ft %>%
merge(output_OD_car1, by.x=c("Origin", "Destination"), by.y=c("fromId", "toId"), all.x=T) %>%
mutate(travel_time = ifelse(is.na(travel_time), 0, travel_time))
rm(output_OD_car1)
summary(od_ft_tt)
od_ft_tt %>% summarise(sum(Persons)) / od_ft_tt %>% filter(is.na(travel_time)) %>% summarise(sum(Persons))
od_ft_tt %>% summarise(sum(Persons)) / od_ft_tt %>% filter(is.na(travel_time)) %>% summarise(sum(Persons))
od_ft_tt %>% summarise(sum(Persons)) / od_ft_tt %>% filter(is.na(travel_time)) %>% summarise(sum(Persons, na.rm = T))
library(readxl)
library(sf)
library(tidyverse)
library(units)
library(ggmap)
library(scales)
#car travel times for all origins to all destinations (matrix)
load(file = "TTS16-data-inputs/Travel-Time-Calculations/results/output_OD_car1.Rdata")
# all, unique, traffic analysis zones with associated number of workers and jobs
load(file = "TTS16-data-inputs/OD-by-FT-Employment/gtha_taz.Rdata")
#Trips taken from origin to destination and associated people
load(file = "TTS16-data-inputs/OD-by-FT-Employment/od_ft.Rdata")
od_ft_tt <- od_ft %>%
merge(output_OD_car1, by.x=c("Origin", "Destination"), by.y=c("fromId", "toId"), all.x=T) %>%
mutate(travel_time = ifelse(is.na(travel_time), 0, travel_time))
rm(output_OD_car1)
summary(od_ft_tt)
od_ft_tt %>%
summarise(sum(Persons)) / od_ft_tt %>% filter(is.na(travel_time)) %>%
summarise(sum(Persons, na.rm = T))
access_jobs <- od_ft_tt %>% filter(travel_time <= 45) %>% group_by(Destination) %>% summarise(jobs_i = sum(Persons, na.rm = T))
gtha_taz_i <- gtha_taz %>% merge(access_jobs, by.x=c("GTA06"), by.y=c("Destination"), all.x=T)
ggplot() +
geom_sf(data = gtha_taz_i,
aes(fill= jobs_i), color = NA) +
scale_fill_distiller(palette = "Spectral")
gtha_taz_cent_tt <- st_centroid(gtha_taz_i) %>% select(GTA06) %>% merge(gtha_taz_i %>% st_drop_geometry(), by="GTA06")
ggplot() +
geom_sf(data = gtha_taz_cent_tt %>% filter(!is.na(jobs_i)),
aes(color=jobs_i, size=AREA), alpha = .5) +
scale_color_distiller(palette = "Spectral")
#car travel times for all origins to all destinations (matrix)
load(file = "TTS16-data-inputs/Travel-Time-Calculations/results/output_OD_car1.Rdata")
# all, unique, traffic analysis zones with associated number of workers and jobs
load(file = "TTS16-data-inputs/OD-by-FT-Employment/gtha_taz.Rdata")
#Trips taken from origin to destination and associated people
load(file = "TTS16-data-inputs/OD-by-FT-Employment/od_ft.Rdata")
library(disk.frame)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(httr)
library(knitr)
#install.packages("kableExtra", dependencies = TRUE) #installing kableExtra and dependencies as I was recieving errors
library(kableExtra)
#install.packages("devtools")
#install.packages("Rtools")
#devtools::install_github("https://github.com/hrbrmstr/lodes.git", dependencies = TRUE) # if you need to download
library(lodes)
library(progress)
library(purrr)
library(r5r)
library(sf)
library(stplanr)
library(tidycensus)
library(tidyr)
library(tmap)
library(zoo) # for rollapplyr
# setup for disk.frame
setup_disk.frame()
options(scipen = 999)
options(java.parameters = "-Xmx6G")
options(future.globals.maxSize = Inf)
tmap_mode("view")
#Trips taken from origin to destination and associated people
load(file = "TTS16-data-inputs/OD-by-FT-Employment/od_ft.Rdata")
od_ft_tt <- od_ft %>%
merge(output_OD_car1, by.x=c("Origin", "Destination"), by.y=c("fromId", "toId"), all.x=T) %>%
mutate(travel_time = ifelse(is.na(travel_time), 0, travel_time))
rm(output_OD_car1)
summary(od_ft_tt)
#car travel times for all origins to all destinations (matrix)
load(file = "TTS16-data-inputs/Travel-Time-Calculations/results/output_OD_car1.Rdata")
#car travel times for all origins to all destinations trips in TTS-16 and number of associated working persons
usethis::use_data(od_ft_tt, overwrite = TRUE)
# all, unique, traffic analysis zones with associated number of workers and jobs per zone
load(file = "TTS16-data-inputs/OD-by-FT-Employment/gtha_taz.Rdata")
usethis::use_data(gtha_taz, overwrite = TRUE)
#boundaries of interest
load(file = "TTS16-data-inputs/Boundaries/hamilton_cma.Rdata")
usethis::use_data(hamilton_cma, overwrite = TRUE)
load(file = "TTS16-data-inputs/Boundaries/toronto_muni_bound.Rdata")
usethis::use_data(toronto_muni_bound, overwrite = TRUE)
load("od_table.rda")
load("/toy-example-data-inputs/od_table.rda")
load("toy-example-data-inputs/od_table.rda")
load("toy-example-data-inputs/simulated_data.rda")
load("toy-example-data-inputs/trips.rda")
View(simulated_data)
View(od_table)
View(trips)
load("toy-example-data-inputs/od_table.rda")
load("toy-example-data-inputs/simulated_data.rda")
load("toy-example-data-inputs/trips.rda")
load("toy-example-data-inputs/od_table.rda")
load("toy-example-data-inputs/simulated_data.rda")
load("toy-example-data-inputs/trips.rda")
load("toy-example-data-inputs/od_table.rda")
toy_od_table <- od_table
load("toy-example-data-inputs/simulated_data.rda")
toy_sim_zones <- simulated_data
load("toy-example-data-inputs/trips.rda")
toy_trips <- trips
load("toy-example-data-inputs/od_table.rda")
toy_od_table <- od_table
load("toy-example-data-inputs/simulated_data.rda")
toy_sim_zones <- simulated_data
load("toy-example-data-inputs/trips.rda")
toy_trips <- trips
usethis::use_data(toy_od_table, overwrite = TRUE)
usethis::use_data(toy_sim_zones, overwrite = TRUE)
usethis::use_data(toy_trips, overwrite = TRUE)
usethis::use_r(name = "SPavailability")
toy_od_table <- toy_od_table %>% select(-[7:10])
toy_od_table <- toy_od_table %>% select(-c("f", "v_ij", "w_ij", "V_ij_r"))
library(sf)
library(tidyverse)
toy_od_table <- toy_od_table %>% select(-c("f", "v_ij", "w_ij", "V_ij_r"))
toy_od_table <- toy_od_table %>% select(-c("f", "V_ij", "w_ij", "V_ij_r"))
toy_od_table <- toy_od_table %>% select(-c("f", "V_ij", "W_ij", "V_ij_r"))
usethis::use_data(toy_od_table, overwrite = TRUE)
load("C:/Users/annie/OneDrive - McMaster University/05. PhD Research/02. MJ/AccessPack/data/gtha_taz.rda")
View(gtha_taz)
sum(gtha_taz$workers)
sum(gtha_taz$jobs)
load("C:/Users/annie/OneDrive - McMaster University/05. PhD Research/02. MJ/AccessPack/data/od_ft_tt.rda")
load("C:/Users/annie/OneDrive - McMaster University/05. PhD Research/02. MJ/AccessPack/data/hamilton_cma.rda")
View(toy_od_table)
View(toy_sim_zones)
devtools::document()
devtools::check()
devtools::build()
devtools::install()
# Edit README.Rmd and then render
devtools::build_readme()
usethis::use_git_ignore("data-raw")
usethis::use_git_ignore("extras")
usethis::use_git()
usethis::use_github()
