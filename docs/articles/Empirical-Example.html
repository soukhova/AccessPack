<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Empirical Example: GTHA Workers • AccessPack</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Empirical Example: GTHA Workers">
<meta property="og:description" content="AccessPack">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AccessPack</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AccessPack-Conventional.html">AccessPack-Conventional</a>
    </li>
    <li>
      <a href="../articles/Empirical-Example.html">Empirical Example: GTHA Workers</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Empirical-Example_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Empirical Example: GTHA Workers</h1>
            
      
      
      <div class="hidden name"><code>Empirical-Example.Rmd</code></div>

    </div>

    
    
<p>In this vignette we calculate both the conventional accessibility and the proposed <em>spatial availability</em> accessibility measures using the 2016 Transportation Tomorrow Survey (TTS) data for the Greater Golden Horseshoe Area (GTHA) in Ontario, Canada. We then explore these measures within the City of Toronto and compare the two calculated accessibility measures.</p>
<p>All data used is contained with the <code>AccessPack</code> data-package and the <em>spatial availability</em> function (<code>sp_avail</code>) is described in detail in the previous vignette.</p>
<div id="empircal-example-set-up" class="section level2">
<h2 class="hasAnchor">
<a href="#empircal-example-set-up" class="anchor"></a>Empircal Example Set-up</h2>
<p>Load packages needed for the example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">AccessPack</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></code></pre></div>
<p>The ‘gtha_taz’ is a spatial object which contains the number of workers, jobs, and area (km^2) for each traffic analysis zone (TAZ), see the workers per area ploted below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_GTHA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">AccessPack</span><span class="fu">::</span><span class="va"><a href="../reference/gtha_taz.html">gtha_taz</a></span>, 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="va">workers</span><span class="op">/</span><span class="va">AREA</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, trans<span class="op">=</span><span class="st">"sqrt"</span><span class="op">)</span>

<span class="va">plot_GTHA</span></code></pre></div>
<p><img src="Empirical-Example_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>The <code>od_ft_tt</code> contains the trips made by workers to jobs (an Orgin-Destination matrix). Each row contains the origin ID for a TAZ, the destination ID for a TAZ, the number of people who complete this trip, and the travel time, by car, as calculated using <code>r5r</code> package for a departure of 7:00am (EST5EDT) on October 20th 2021 (a date selected at random). See “-raw” folder for data preparation .Rmd</p>
<p>Below is a summary of ‘od_ft_tt’ object:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu">AccessPack</span><span class="fu">::</span><span class="va"><a href="../reference/od_ft_tt.html">od_ft_tt</a></span><span class="op">)</span>
<span class="co">#&gt;     Origin          Destination           Persons         travel_time   </span>
<span class="co">#&gt;  Length:103076      Length:103076      Min.   :   1.00   Min.   :  0.0  </span>
<span class="co">#&gt;  Class :character   Class :character   1st Qu.:  14.00   1st Qu.: 12.0  </span>
<span class="co">#&gt;  Mode  :character   Mode  :character   Median :  22.00   Median : 20.0  </span>
<span class="co">#&gt;                                        Mean   :  33.44   Mean   : 22.6  </span>
<span class="co">#&gt;                                        3rd Qu.:  38.00   3rd Qu.: 30.0  </span>
<span class="co">#&gt;                                        Max.   :1129.00   Max.   :179.0</span></code></pre></div>
</div>
<div id="conventional-accessibility" class="section level2">
<h2 class="hasAnchor">
<a href="#conventional-accessibility" class="anchor"></a>Conventional Accessibility</h2>
<p>Using the TTS-16 dataset describe in the previous section; let’s calculate conventional accessibility.</p>
<p>First, we must pick an impedence function. Let’s assume an impedance function of a binary 45 mins or less; meaning any job which can be reach in more than 45 min is not considered in evaluating the job accessibility for each origin.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#add the number of jobs and workers to the od_ft_tt matrix</span>
<span class="va">od_ft</span> <span class="op">&lt;-</span> <span class="fu">AccessPack</span><span class="fu">::</span><span class="va"><a href="../reference/od_ft_tt.html">od_ft_tt</a></span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">gtha_taz</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">GTA06</span>, <span class="va">workers</span><span class="op">)</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span>,
                   by.x <span class="op">=</span> <span class="st">"Origin"</span>, by.y<span class="op">=</span><span class="st">"GTA06"</span>, all.x <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="va">od_ft</span> <span class="op">&lt;-</span> <span class="va">od_ft</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">gtha_taz</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">GTA06</span>, <span class="va">jobs</span><span class="op">)</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span>,
                   by.x <span class="op">=</span> <span class="st">"Destination"</span>, by.y<span class="op">=</span><span class="st">"GTA06"</span>, all.x <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="co">#filter in only trips which are 45 mins or less, and summarize the sums of all jobs within each destination</span>
<span class="va">c_accessibility</span> <span class="op">&lt;-</span> <span class="va">od_ft</span>  <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">travel_time</span> <span class="op">&lt;=</span> <span class="fl">45</span><span class="op">)</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Origin</span><span class="op">)</span>  <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>c_access_jobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">jobs</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now merge accessibly calculation to the gtha_taz and assign all NULL c_access_jobs value to “0”:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gtha_taz_acc</span> <span class="op">&lt;-</span> <span class="fu">AccessPack</span><span class="fu">::</span><span class="va"><a href="../reference/gtha_taz.html">gtha_taz</a></span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">c_accessibility</span>, by.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GTA06"</span><span class="op">)</span>, by.y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Origin"</span><span class="op">)</span>, all.x<span class="op">=</span><span class="cn">T</span><span class="op">)</span> 

<span class="va">gtha_taz_acc</span> <span class="op">&lt;-</span> <span class="va">gtha_taz_acc</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>c_access_jobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">c_access_jobs</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">c_access_jobs</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Plot conventional accessibility (accessible jobs in each TAZ):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_c_access</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gtha_taz_acc</span>, 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="va">c_access_jobs</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, trans<span class="op">=</span><span class="st">"sqrt"</span><span class="op">)</span>

<span class="va">plot_c_access</span></code></pre></div>
<p><img src="Empirical-Example_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="spatial-availability" class="section level2">
<h2 class="hasAnchor">
<a href="#spatial-availability" class="anchor"></a>Spatial Availability</h2>
<p>Using the TTS-16 dataset describe in the first section; let’s calculate <em>spatial availability</em>.</p>
<p>First, pick some beta value and calculate some impedance function for our travel cost variable. Here we assume a beta value of 0.0015, an exponential decay impedance function, and travel time (in minutes) to be our travel cost variable:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">0.0015</span>
<span class="va">od_ft</span> <span class="op">&lt;-</span> <span class="va">od_ft</span>  <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>f <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">beta</span> <span class="op">*</span> <span class="va">travel_time</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Now calculate <em>spatial availability</em>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">od_ft</span> <span class="op">&lt;-</span> <span class="va">od_ft</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>catch <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>V_ij <span class="op">=</span> <span class="fu"><a href="../reference/sp_avail.html">sp_avail</a></span><span class="op">(</span><span class="va">.</span>, 
                         o_id <span class="op">=</span> <span class="va">Origin</span>,
                         d_id <span class="op">=</span> <span class="va">Destination</span>,
                         pop <span class="op">=</span> <span class="va">workers</span>,
                         opp <span class="op">=</span> <span class="va">jobs</span>,
                         r <span class="op">=</span> <span class="va">catch</span>,
                         f <span class="op">=</span> <span class="va">f</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Verify that the sum of all jobs allocated is consistent with the total number of jobs (<em>this property is this measures novel contribution</em>):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">od_ft</span><span class="op">$</span><span class="va">V_ij</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co">#&gt; [1] 3081900</span>

<span class="va">sum_jobs</span> <span class="op">&lt;-</span> <span class="va">od_ft</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Destination</span><span class="op">)</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>jobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">jobs</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sum_jobs</span><span class="op">$</span><span class="va">jobs</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">#&gt; [1] 3081900</span></code></pre></div>
<p>The total number of jobs is preserved.</p>
<p>Aggregate available jobs (‘V_ij’) by origin:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">availability</span> <span class="op">&lt;-</span> <span class="va">od_ft</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Origin</span><span class="op">)</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>avail_jobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">V_ij</span><span class="op">)</span><span class="op">)</span> 

<span class="va">availability</span>
<span class="co">#&gt; # A tibble: 2,973 x 2</span>
<span class="co">#&gt;    Origin avail_jobs</span>
<span class="co">#&gt;    &lt;chr&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1 1          NA    </span>
<span class="co">#&gt;  2 100        NA    </span>
<span class="co">#&gt;  3 1001       NA    </span>
<span class="co">#&gt;  4 1002       NA    </span>
<span class="co">#&gt;  5 1003       NA    </span>
<span class="co">#&gt;  6 1007        0.245</span>
<span class="co">#&gt;  7 1008       NA    </span>
<span class="co">#&gt;  8 101        NA    </span>
<span class="co">#&gt;  9 1011        0.834</span>
<span class="co">#&gt; 10 1012        1.06 </span>
<span class="co">#&gt; # ... with 2,963 more rows</span></code></pre></div>
<p>Now merge accessibly calculation to the gtha_taz and assign all NULL c_access_jobs value to “0”:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gtha_taz_acc</span> <span class="op">&lt;-</span> <span class="va">gtha_taz_acc</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">availability</span>, by.x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GTA06"</span><span class="op">)</span>, by.y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Origin"</span><span class="op">)</span>, all.x<span class="op">=</span><span class="cn">T</span><span class="op">)</span> 

<span class="va">gtha_taz_acc</span> <span class="op">&lt;-</span> <span class="va">gtha_taz_acc</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>avail_jobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">avail_jobs</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">avail_jobs</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Plot <em>spatial availability</em> (accessible <em>available</em> jobs in each TAZ):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_avail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gtha_taz_acc</span>, 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="va">avail_jobs</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, trans<span class="op">=</span><span class="st">"sqrt"</span><span class="op">)</span>

<span class="va">plot_avail</span></code></pre></div>
<p><img src="Empirical-Example_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div id="comparing-conventional-accessibility-and-spatial-availability" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-conventional-accessibility-and-spatial-availability" class="anchor"></a>Comparing Conventional Accessibility and Spatial Availability</h2>
<p>Plot origin conventional accessibility vs. availability (with the City of Toronto Boundary):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_avail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gtha_taz_acc</span>, 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="va">avail_jobs</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, trans<span class="op">=</span><span class="st">"sqrt"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">AccessPack</span><span class="fu">::</span><span class="va"><a href="../reference/toronto_muni_bound.html">toronto_muni_bound</a></span>, colour<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>

<span class="va">plot_c_access</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">gtha_taz_acc</span>, 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="va">c_access_jobs</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, trans<span class="op">=</span><span class="st">"sqrt"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">AccessPack</span><span class="fu">::</span><span class="va"><a href="../reference/toronto_muni_bound.html">toronto_muni_bound</a></span>, colour<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>


<span class="va">plot_avail</span> <span class="op">/</span> <span class="va">plot_c_access</span></code></pre></div>
<p><img src="Empirical-Example_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<ul>
<li>at the GTHA resolution, we see here how the conventional accessibility relatively over-inflates the number of jobs available in the more densely populated (and higher number of jobs) within the Toronto area</li>
</ul>
<p>Let’s take a closer look at the measures just within the City of Toronto boundary.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#transform CRS</span>
<span class="va">toronto_muni_bound</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html">st_transform</a></span><span class="op">(</span><span class="fu">AccessPack</span><span class="fu">::</span><span class="va"><a href="../reference/toronto_muni_bound.html">toronto_muni_bound</a></span>, crs<span class="op">=</span><span class="fl">32617</span><span class="op">)</span>

<span class="co">#select only zones within Toronto Municipality</span>
<span class="va">TO_taz_acc</span> <span class="op">&lt;-</span> <span class="va">gtha_taz_acc</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html">st_intersects</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">toronto_muni_bound</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p>Plot origin conventional accessibility vs. availability for Toronto</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_avail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">TO_taz_acc</span>, 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="va">avail_jobs</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>,  trans <span class="op">=</span> <span class="st">"sqrt"</span><span class="op">)</span>

<span class="va">plot_c_access</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">TO_taz_acc</span>, 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="va">c_access_jobs</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, trans <span class="op">=</span> <span class="st">"sqrt"</span><span class="op">)</span>

<span class="va">plot_avail</span> <span class="op">/</span> <span class="va">plot_c_access</span></code></pre></div>
<p><img src="Empirical-Example_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Let’s try normalizing number of workers from origin (we don’t have population of TAZ in this dataset):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot_avail</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">TO_taz_acc</span>, 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="va">avail_jobs</span> <span class="op">/</span> <span class="va">workers</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>,  trans <span class="op">=</span> <span class="st">"sqrt"</span><span class="op">)</span>

<span class="va">plot_c_access</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">TO_taz_acc</span>, 
          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span> <span class="va">c_access_jobs</span><span class="op">/</span> <span class="va">workers</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Spectral"</span>, trans <span class="op">=</span> <span class="st">"sqrt"</span><span class="op">)</span>

<span class="va">plot_avail</span> <span class="op">/</span> <span class="va">plot_c_access</span></code></pre></div>
<p><img src="Empirical-Example_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Anastasia Soukhov, Antonio Paez.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
